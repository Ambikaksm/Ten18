#include "Ten18/Capture/MediaFoundationLogger.h"
#include "Ten18/COM/COMPtr.h"
#include "Ten18/COM/COMArray.h"
#include "Ten18/Expect.h"
#include "Ten18/OnExit.h"
#include "Ten18/Timer.h"
#include "Ten18/Image.h"

using namespace Ten18;
using namespace Ten18::Capture;

struct GuidAndName
{
    GUID guid;
    const char* name;
};

bool operator < (const GuidAndName& lhs, const GuidAndName& rhs)
{ 
    return std::memcmp(&lhs.guid, &rhs.guid, sizeof(GUID)) < 0;
}

GuidAndName knownGuidNames[] = {

    #define Ten18_KNOWN_GUID_AND_NAME(name) \
        { name, #name },

        Ten18_KNOWN_GUID_AND_NAME(AMPROPSETID_Pin)
        Ten18_KNOWN_GUID_AND_NAME(AM_MEDIA_TYPE_REPRESENTATION)
        Ten18_KNOWN_GUID_AND_NAME(CAPTION_FORMAT_ATSC)
        Ten18_KNOWN_GUID_AND_NAME(CAPTION_FORMAT_DIRECTV)
        Ten18_KNOWN_GUID_AND_NAME(CAPTION_FORMAT_DVB)
        Ten18_KNOWN_GUID_AND_NAME(CAPTION_FORMAT_ECHOSTAR)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_ACMWrapper)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_ATSCNetworkPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_ATSCNetworkProvider)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AVICo)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AVIDec)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AVIDoc)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AVIDraw)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AVIMIDIRender)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_ActiveMovieCategories)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AllocPresenter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AllocPresenterDDXclMode)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AnalogVideoDecoderPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AsyncReader)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AudioCompressorCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AudioInputDeviceCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AudioInputMixerProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AudioProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AudioRecord)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AudioRender)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AudioRendererAdvancedProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AudioRendererCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AviDest)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AviMuxProptyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AviMuxProptyPage1)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AviReader)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_AviSplitter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CAcmCoClassManager)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CCAFilter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CDeviceMoniker)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CIcmCoClassManager)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CMidiOutClassManager)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CMpegAudioCodec)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CMpegVideoCodec)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CQzFilterClassManager)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CVidCapClassManager)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CWaveOutClassManager)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CWaveinClassManager)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CameraControlPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CaptionsFilter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CaptureGraphBuilder)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CaptureGraphBuilder2)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CaptureProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_Colour)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_CrossbarFilterPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DShowTVEFilter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DSoundRender)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVBCNetworkProvider)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVBSNetworkProvider)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVBTNetworkProvider)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVDHWDecodersCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVDNavigator)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVDState)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVDecPropertiesPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVEncPropertiesPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVMux)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVMuxPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVSplitter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVVideoCodec)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DVVideoEnc)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DeviceControlCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DirectDraw)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DirectDrawClipper)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DirectDrawProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DirectShowPluginControl)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_Dither)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DtvCcFilter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_DvdGraphBuilder)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_EVRPlaybackPipelineOptimizer)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_EVRTearlessWindowPresenter9)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_EnhancedVideoRenderer)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_FGControl)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_FileSource)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_FileWriter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_FilterGraph)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_FilterGraphNoThread)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_FilterGraphPrivateThread)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_FilterMapper)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_FilterMapper2)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_ICodecAPIProxy)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_IVideoEncoderCodecAPIProxy)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_IVideoEncoderProxy)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_InfTee)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_LegacyAmFilterCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_Line21Decoder)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_Line21Decoder2)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MFSourceResolver)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MFVideoMixer9)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MFVideoPresenter9)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MJPGEnc)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MMSPLITTER)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MOVReader)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MPEG1Doc)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MPEG1PacketPlayer)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MPEG1Splitter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MPEG2Demultiplexer)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MPEG2Demultiplexer_NoClock)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MediaEncoderCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MediaMultiplexerCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MediaPropertyBag)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MemoryAllocator)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MidiRendererCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_MjpegDec)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_ModexProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_ModexRenderer)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_Mpeg2VideoStreamAnalyzer)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_NetworkProvider)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_OverlayMixer)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_PerformanceProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_PersistMonikerPID)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_ProtoFilterGraph)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_QTDec)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_QualityProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_QuickTimeParser)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_SBE2File)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_SBE2FileScan)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_SBE2MediaTypeProfile)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_SBE2Sink)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_SeekingPassThru)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_SmartTee)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_StreamBufferComposeRecording)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_StreamBufferConfig)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_StreamBufferPropertyHandler)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_StreamBufferRecordingAttributes)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_StreamBufferSink)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_StreamBufferSource)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_StreamBufferThumbnailHandler)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_SubtitlesFilter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_SystemClock)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_SystemDeviceEnum)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_TVAudioFilterPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_TVEFilterCCProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_TVEFilterStatsProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_TVEFilterTuneProperties)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_TVTunerFilterPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_TextRender)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_TransmitCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_URLReader)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VBISurfaces)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VPObject)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VPVBIObject)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VfwCapture)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VideoCompressorCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VideoInputDeviceCategory)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VideoMixingRenderer)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VideoMixingRenderer9)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VideoPortManager)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VideoProcAmpPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VideoRenderer)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VideoRendererDefault)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_VideoStreamConfigPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_WMAsfReader)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_WMAsfWriter)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_WSTDecoder)
        Ten18_KNOWN_GUID_AND_NAME(CLSID_WstDecoderPropertyPage)
        Ten18_KNOWN_GUID_AND_NAME(CODECAPI_ALLSETTINGS)
        Ten18_KNOWN_GUID_AND_NAME(CODECAPI_AUDIO_ENCODER)
        Ten18_KNOWN_GUID_AND_NAME(CODECAPI_AVDecMmcssClass)
        Ten18_KNOWN_GUID_AND_NAME(CODECAPI_CHANGELISTS)
        Ten18_KNOWN_GUID_AND_NAME(CODECAPI_CURRENTCHANGELIST)
        Ten18_KNOWN_GUID_AND_NAME(CODECAPI_SETALLDEFAULTS)
        Ten18_KNOWN_GUID_AND_NAME(CODECAPI_SUPPORTSEVENTS)
        Ten18_KNOWN_GUID_AND_NAME(CODECAPI_VIDEO_ENCODER)
        Ten18_KNOWN_GUID_AND_NAME(DSATTRIB_CAPTURE_STREAMTIME)
        Ten18_KNOWN_GUID_AND_NAME(DSATTRIB_CC_CONTAINER_INFO)
        Ten18_KNOWN_GUID_AND_NAME(DSATTRIB_DSHOW_STREAM_DESC)
        Ten18_KNOWN_GUID_AND_NAME(DSATTRIB_OptionalVideoAttributes)
        Ten18_KNOWN_GUID_AND_NAME(DSATTRIB_PBDATAG_ATTRIBUTE)
        Ten18_KNOWN_GUID_AND_NAME(DSATTRIB_PicSampleSeq)
        Ten18_KNOWN_GUID_AND_NAME(DSATTRIB_SAMPLE_LIVE_STREAM_TIME)
        Ten18_KNOWN_GUID_AND_NAME(DSATTRIB_TRANSPORT_PROPERTIES)
        Ten18_KNOWN_GUID_AND_NAME(DSATTRIB_UDCRTag)
        Ten18_KNOWN_GUID_AND_NAME(ENCAPIPARAM_BITRATE)
        Ten18_KNOWN_GUID_AND_NAME(ENCAPIPARAM_BITRATE_MODE)
        Ten18_KNOWN_GUID_AND_NAME(ENCAPIPARAM_PEAK_BITRATE)
        Ten18_KNOWN_GUID_AND_NAME(ENCAPIPARAM_SAP_MODE)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_AllowBatching)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_AllowDropToBob)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_AllowDropToHalfInterlace)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_AllowDropToThrottle)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_AllowScaling)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_ForceBatching)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_ForceBob)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_ForceHalfInterlace)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_ForceScaling)
        Ten18_KNOWN_GUID_AND_NAME(EVRConfig_ForceThrottle)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_525WSS)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_AnalogVideo)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_CAPTIONED_H264VIDEO)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_CAPTIONED_MPEG2VIDEO)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_CC_CONTAINER)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_DvInfo)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_MFVideoFormat)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_MPEGStreams)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_MPEGVideo)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_None)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_VideoInfo)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_VideoInfo2)
        Ten18_KNOWN_GUID_AND_NAME(FORMAT_WaveFormatEx)
        Ten18_KNOWN_GUID_AND_NAME(IID_IAMDirectSound)
        Ten18_KNOWN_GUID_AND_NAME(IID_IAMLine21Decoder)
        Ten18_KNOWN_GUID_AND_NAME(IID_IAMWstDecoder)
        Ten18_KNOWN_GUID_AND_NAME(IID_IBaseVideoMixer)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDDVideoPortContainer)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDraw)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDraw2)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawClipper)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawColorControl)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawKernel)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawPalette)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface2)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface3)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface4)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface7)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurfaceKernel)
        Ten18_KNOWN_GUID_AND_NAME(IID_IDirectDrawVideo)
        Ten18_KNOWN_GUID_AND_NAME(IID_IFullScreenVideo)
        Ten18_KNOWN_GUID_AND_NAME(IID_IFullScreenVideoEx)
        Ten18_KNOWN_GUID_AND_NAME(IID_IMixerPinConfig)
        Ten18_KNOWN_GUID_AND_NAME(IID_IMixerPinConfig2)
        Ten18_KNOWN_GUID_AND_NAME(IID_IMpegAudioDecoder)
        Ten18_KNOWN_GUID_AND_NAME(IID_IQualProp)
        Ten18_KNOWN_GUID_AND_NAME(IID_IVPConfig)
        Ten18_KNOWN_GUID_AND_NAME(IID_IVPControl)
        Ten18_KNOWN_GUID_AND_NAME(IID_IVPNotify)
        Ten18_KNOWN_GUID_AND_NAME(IID_IVPNotify2)
        Ten18_KNOWN_GUID_AND_NAME(IID_IVPObject)
        Ten18_KNOWN_GUID_AND_NAME(IID_IVPVBIConfig)
        Ten18_KNOWN_GUID_AND_NAME(IID_IVPVBINotify)
        Ten18_KNOWN_GUID_AND_NAME(IID_IVPVBIObject)
        Ten18_KNOWN_GUID_AND_NAME(LOOK_DOWNSTREAM_ONLY)
        Ten18_KNOWN_GUID_AND_NAME(LOOK_UPSTREAM_ONLY)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_708_608Data)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_A2B10G10R10)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_A2R10G10B10)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AI44)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AIFF)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB32)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB32_D3D_DX7_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB32_D3D_DX9_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB1555)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB1555_D3D_DX7_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB1555_D3D_DX9_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB4444)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB4444_D3D_DX7_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB4444_D3D_DX9_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AU)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AYUV)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_NTSC_M)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_B)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_D)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_G)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_H)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_I)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_M)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_N)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_N_COMBO)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_B)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_D)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_G)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_H)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_K)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_K1)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_L)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Asf)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Avi)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CC_CONTAINER)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CFCC)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CLJR)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CLPL)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CPLA)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DOLBY_AC3_SPDIF)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DRM_Audio)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DVB_SUBTITLES)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DVCS)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DVSD)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DssAudio)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DssVideo)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DtvCcData)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_H264)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IA44)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IEEE_FLOAT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IF09)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IJPG)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IMC1)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IMC2)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IMC3)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IMC4)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ISDB_CAPTIONS)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ISDB_SUPERIMPOSE)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IYUV)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Line21_BytePair)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Line21_GOPPacket)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Line21_VBIRawData)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MDVF)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MJPG)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1Audio)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1AudioPayload)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1Packet)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1Payload)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1System)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1Video)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1VideoCD)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_NV11)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_NV12)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_NV24)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_None)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Overlay)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P010)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P016)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P208)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P210)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P216)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P408)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_PCM)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_PCMAudio_Obsolete)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Plum)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTJpeg)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTMovie)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTRle)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTRpza)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTSmc)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RAW_SPORT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB1)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB4)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB8)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB16_D3D_DX7_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB16_D3D_DX9_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB24)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB32)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB32_D3D_DX7_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB32_D3D_DX9_RT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB555)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB565)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_S340)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_S342)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_SPDIF_TAG_241h)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_TELETEXT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_TVMJ)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_UYVY)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_VBI)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_VPS)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_VPVBI)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_VPVideo)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_WAKE)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_WAVE)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_WSS)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_XDS)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y41P)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y210)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y211)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y216)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y411)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YUY2)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YUYV)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YV12)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YVU9)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YVYU)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dv25)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dv50)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dvh1)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dvhd)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dvsd)
        Ten18_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dvsl)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_AUXLine21Data)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_AUXTeletextPage)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_AnalogAudio)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_AnalogVideo)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_Audio)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_CC_CONTAINER)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_DTVCCData)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_File)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_Interleaved)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_LMRT)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_MPEG1SystemStream)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_MSTVCaption)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_Midi)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_ScriptCommand)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_Stream)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_Text)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_Timecode)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_URL_STREAM)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_VBI)
        Ten18_KNOWN_GUID_AND_NAME(MEDIATYPE_Video)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_AAC)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_ADTS)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_Base)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_DRM)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_DTS)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_Dolby_AC3_SPDIF)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_Float)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_MP3)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_MPEG)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_MSP1)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_PCM)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_WMASPDIF)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_WMAudioV8)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_WMAudioV9)
        Ten18_KNOWN_GUID_AND_NAME(MFAudioFormat_WMAudio_Lossless)
        Ten18_KNOWN_GUID_AND_NAME(MFMPEG4Format_Base)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_Audio)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_Binary)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_Default)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_FileTransfer)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_HTML)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_Image)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_Protected)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_SAMI)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_Script)
        Ten18_KNOWN_GUID_AND_NAME(MFMediaType_Video)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_BottomFieldFirst)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_CleanPoint)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_DerivedFromTopField)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_DescrambleData)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_Discontinuity)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_GenKeyCtx)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_GenKeyFunc)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_Interlaced)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_PacketCrossOffsets)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_RepeatFirstField)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_SampleKeyID)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_SingleField)
        Ten18_KNOWN_GUID_AND_NAME(MFSampleExtension_Token)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_AUDIO_DECODER)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_AUDIO_EFFECT)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_AUDIO_ENCODER)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_DEMULTIPLEXER)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_MULTIPLEXER)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_OTHER)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_VIDEO_DECODER)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_VIDEO_EFFECT)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_VIDEO_ENCODER)
        Ten18_KNOWN_GUID_AND_NAME(MFT_CATEGORY_VIDEO_PROCESSOR)
        Ten18_KNOWN_GUID_AND_NAME(MFT_SUPPORT_DYNAMIC_FORMAT_CHANGE)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_AI44)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_ARGB32)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_AYUV)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_Base)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_DV25)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_DV50)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_DVC)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_DVH1)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_DVHD)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_DVSD)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_DVSL)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_H264)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_I420)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_IYUV)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_M4S2)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_MJPG)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_MP4S)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_MP4V)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_MP43)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_MPEG2)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_MPG1)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_MSS1)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_MSS2)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_NV11)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_NV12)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_P010)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_P016)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_P210)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_P216)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB8)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB24)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB32)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB555)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB565)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_UYVY)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_WMV1)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_WMV2)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_WMV3)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_WVC1)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_Y41P)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_Y41T)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_Y42T)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_Y210)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_Y216)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_Y410)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_Y416)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_YUY2)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_YV12)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_YVU9)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_YVYU)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_v210)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_v216)
        Ten18_KNOWN_GUID_AND_NAME(MFVideoFormat_v410)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_DO_THINNING)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_MFT_CONTEXT)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_MFT_INPUT_STREAM_ID)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_OUTPUT_NODE)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_PRESENTATION_TIME_OFFSET)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_SCRUBSAMPLE_TIME)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_SESSIONCAPS)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_SESSIONCAPS_DELTA)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_ACTUAL_START)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_CHARACTERISTICS)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_CHARACTERISTICS_OLD)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_FAKE_START)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_PROJECTSTART)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_TOPOLOGY_CANCELED)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_START_PRESENTATION_TIME)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_START_PRESENTATION_TIME_AT_OUTPUT)
        Ten18_KNOWN_GUID_AND_NAME(MF_EVENT_TOPOLOGY_STATUS)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AAC_AUDIO_PROFILE_LEVEL_INDICATION)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AAC_PAYLOAD_TYPE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_ALL_SAMPLES_INDEPENDENT)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AM_FORMAT_TYPE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_ARBITRARY_FORMAT)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_ARBITRARY_HEADER)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_AVG_BYTES_PER_SECOND)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_BITS_PER_SAMPLE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_BLOCK_ALIGNMENT)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_CHANNEL_MASK)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_FLOAT_SAMPLES_PER_SECOND)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_FOLDDOWN_MATRIX)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_NUM_CHANNELS)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_PREFER_WAVEFORMATEX)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_SAMPLES_PER_BLOCK)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_SAMPLES_PER_SECOND)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_VALID_BITS_PER_SAMPLE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_WMADRC_AVGREF)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_WMADRC_AVGTARGET)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_WMADRC_PEAKREF)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_WMADRC_PEAKTARGET)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AVG_BITRATE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_AVG_BIT_ERROR_RATE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_COMPRESSED)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_CUSTOM_VIDEO_PRIMARIES)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_DEFAULT_STRIDE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_DRM_FLAGS)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_DV_AAUX_CTRL_PACK_0)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_DV_AAUX_CTRL_PACK_1)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_DV_AAUX_SRC_PACK_0)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_DV_AAUX_SRC_PACK_1)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_DV_VAUX_CTRL_PACK)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_DV_VAUX_SRC_PACK)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_FIXED_SIZE_SAMPLES)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_FRAME_RATE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_FRAME_RATE_RANGE_MAX)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_FRAME_RATE_RANGE_MIN)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_FRAME_SIZE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_GEOMETRIC_APERTURE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_IMAGE_LOSS_TOLERANT)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_INTERLACE_MODE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MAJOR_TYPE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MAX_KEYFRAME_SPACING)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MINIMUM_DISPLAY_APERTURE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MPEG2_FLAGS)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MPEG2_LEVEL)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MPEG2_PROFILE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MPEG4_CURRENT_SAMPLE_ENTRY)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MPEG4_SAMPLE_DESCRIPTION)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MPEG_SEQUENCE_HEADER)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_MPEG_START_TIME_CODE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_ORIGINAL_4CC)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_ORIGINAL_WAVE_FORMAT_TAG)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_PAD_CONTROL_FLAGS)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_PALETTE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_PAN_SCAN_APERTURE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_PAN_SCAN_ENABLED)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_PIXEL_ASPECT_RATIO)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_SAMPLE_SIZE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_SOURCE_CONTENT_HINT)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_SUBTYPE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_TRANSFER_FUNCTION)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_USER_DATA)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_VIDEO_CHROMA_SITING)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_VIDEO_LIGHTING)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_VIDEO_NOMINAL_RANGE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_VIDEO_PRIMARIES)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_WRAPPED_TYPE)
        Ten18_KNOWN_GUID_AND_NAME(MF_MT_YUV_MATRIX)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_ANALOGVIDEOIN)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_CAPTURE)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_CC)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_EDS)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_NABTS)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_PREVIEW)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_STILL)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_TELETEXT)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_TIMECODE)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_VBI)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_VIDEOPORT)
        Ten18_KNOWN_GUID_AND_NAME(PIN_CATEGORY_VIDEOPORT_VBI)
        Ten18_KNOWN_GUID_AND_NAME(TIME_FORMAT_BYTE)
        Ten18_KNOWN_GUID_AND_NAME(TIME_FORMAT_FIELD)
        Ten18_KNOWN_GUID_AND_NAME(TIME_FORMAT_FRAME)
        Ten18_KNOWN_GUID_AND_NAME(TIME_FORMAT_MEDIA_TIME)
        Ten18_KNOWN_GUID_AND_NAME(TIME_FORMAT_NONE)
        Ten18_KNOWN_GUID_AND_NAME(TIME_FORMAT_SAMPLE)
        Ten18_KNOWN_GUID_AND_NAME(UUID_UdriTagTables)
        Ten18_KNOWN_GUID_AND_NAME(UUID_WMDRMTagTables)            
        Ten18_KNOWN_GUID_AND_NAME(GUID_NULL)            
    
    #undef Ten18_KNOWN_GUID_AND_NAME
};

GuidAndName* knownGuidNamesBegin = knownGuidNames;
GuidAndName* knownGuidNamesEnd = knownGuidNames + sizeof(knownGuidNames) / sizeof(knownGuidNames[0]);

static std::string GuidToString(const GUID& guid)
{
    const int len = 37;
    char raw[len];     
    _snprintf_s(raw, len, "%08X-%04hX-%04hX-%02X%02X-%02X%02X%02X%02X%02X%02X",
                guid.Data1, guid.Data2, guid.Data3,
                static_cast<uint32_t>(guid.Data4[0]), static_cast<uint32_t>(guid.Data4[1]),
                static_cast<uint32_t>(guid.Data4[2]), static_cast<uint32_t>(guid.Data4[3]),
                static_cast<uint32_t>(guid.Data4[4]), static_cast<uint32_t>(guid.Data4[5]),
                static_cast<uint32_t>(guid.Data4[6]), static_cast<uint32_t>(guid.Data4[7]));
    return std::string(raw);
}

static std::string GuidToName(const GUID& guid)
{
    // Todo, Jaap Suter, June 2011: not thread safe;
    static bool initialized = false;
    if (!initialized)
    {
        std::sort(knownGuidNamesBegin, knownGuidNamesEnd);
        initialized = true;
    }

    GuidAndName guidWithoutName = { guid, nullptr };
    std::pair<const GuidAndName*, const GuidAndName*> range = std::equal_range(knownGuidNamesBegin, knownGuidNamesEnd, guidWithoutName);
    if (0 == std::distance(range.first, range.second))
        return GuidToString(guid);
    else
        return std::string(range.first->name);
}

static std::string SpecialCaseAttributeValue(const GUID& guid, const PROPVARIANT& var)
{
    if (guid == MF_MT_FRAME_RATE || 
        guid == MF_MT_FRAME_RATE_RANGE_MAX ||
        guid == MF_MT_FRAME_RATE_RANGE_MIN || 
        guid == MF_MT_FRAME_SIZE ||
        guid == MF_MT_PIXEL_ASPECT_RATIO)
    {
        UINT32 uHigh = 0;
        UINT32 uLow = 0;
        Unpack2UINT32AsUINT64(var.uhVal.QuadPart, &uHigh, &uLow);
		std::ostringstream str;
		str << uHigh << '/' << uLow;
        return str.str();
    }
    else return std::string();
}

static void LogAttributeValueByIndex(IMFAttributes& attr, DWORD index)
{
    PROPVARIANT var;
    OnExit oe([&var] () { PropVariantClear(&var); });

    std::ostream& ostr = std::cout;
        
    GUID guid = {};
    PropVariantInit(&var);

    Expect.HR = attr.GetItemByIndex(index, &guid, &var);
        
    ostr << "\t: " << GuidToName(guid) << std::endl;

    auto val = SpecialCaseAttributeValue(guid, var);
    if (val.size() > 0)
    {
        ostr << "\t: " << val << std::endl;
    }
    else
    {
        switch (var.vt)
        {
        case VT_UI4:
            ostr << "\t: " << var.ulVal << std::endl;
            break;

        case VT_UI8:
            ostr << "\t: " << *reinterpret_cast<std::int64_t*>(&var.uhVal) << std::endl;
            break;

        case VT_R8:
            ostr << "\t: " << var.dblVal << std::endl;
            break;

        case VT_CLSID:
            ostr << "\t: " << GuidToName(*var.puuid) << std::endl;
            break;

        case VT_LPWSTR:
            ostr << "\t: " << var.pwszVal << std::endl;
            break;

        case VT_VECTOR | VT_UI1:
            ostr << "\t: array<byte>";
            break;

        case VT_UNKNOWN:
            ostr << "\t: IUnknown" << std::endl;
            break;

        default:
            ostr << "\t: Unexpected attribute type (vt = " << var.vt << ")" << std::endl;
            break;
        }
    }
}

void MediaFoundationLogger::Log(IMFMediaType& mediaType)
{
	UINT32 count = 0;
    Expect.HR = mediaType.GetCount(&count);
    
    for (UINT32 i = 0; i < count; i++)
        LogAttributeValueByIndex(mediaType, i);
}
