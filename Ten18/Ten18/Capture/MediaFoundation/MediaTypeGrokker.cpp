#include "Pentacorn/Precompiled.Cpp.hpp"
#include "Pentacorn/Capture/MediaFoundation/MediaTypeGrokker.hpp"
#include "Pentacorn/Error.hpp"

namespace Pentacorn { namespace Capture { namespace MediaFoundation {

struct GuidAndName
{
    GUID guid;
    const char* name;
};

bool operator < (const GuidAndName& lhs, const GuidAndName& rhs)
{ 
    return std::memcmp(&lhs.guid, &rhs.guid, sizeof(GUID)) < 0;
}

GuidAndName knownGuidNames[] = {

    #define PENTACORN_KNOWN_GUID_AND_NAME(name) \
        { name, #name },

        PENTACORN_KNOWN_GUID_AND_NAME(AMPROPSETID_Pin)
        PENTACORN_KNOWN_GUID_AND_NAME(AM_MEDIA_TYPE_REPRESENTATION)
        PENTACORN_KNOWN_GUID_AND_NAME(CAPTION_FORMAT_ATSC)
        PENTACORN_KNOWN_GUID_AND_NAME(CAPTION_FORMAT_DIRECTV)
        PENTACORN_KNOWN_GUID_AND_NAME(CAPTION_FORMAT_DVB)
        PENTACORN_KNOWN_GUID_AND_NAME(CAPTION_FORMAT_ECHOSTAR)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_ACMWrapper)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_ATSCNetworkPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_ATSCNetworkProvider)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AVICo)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AVIDec)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AVIDoc)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AVIDraw)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AVIMIDIRender)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_ActiveMovieCategories)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AllocPresenter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AllocPresenterDDXclMode)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AnalogVideoDecoderPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AsyncReader)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AudioCompressorCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AudioInputDeviceCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AudioInputMixerProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AudioProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AudioRecord)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AudioRender)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AudioRendererAdvancedProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AudioRendererCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AviDest)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AviMuxProptyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AviMuxProptyPage1)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AviReader)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_AviSplitter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CAcmCoClassManager)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CCAFilter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CDeviceMoniker)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CIcmCoClassManager)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CMidiOutClassManager)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CMpegAudioCodec)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CMpegVideoCodec)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CQzFilterClassManager)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CVidCapClassManager)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CWaveOutClassManager)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CWaveinClassManager)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CameraControlPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CaptionsFilter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CaptureGraphBuilder)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CaptureGraphBuilder2)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CaptureProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_Colour)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_CrossbarFilterPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DShowTVEFilter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DSoundRender)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVBCNetworkProvider)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVBSNetworkProvider)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVBTNetworkProvider)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVDHWDecodersCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVDNavigator)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVDState)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVDecPropertiesPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVEncPropertiesPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVMux)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVMuxPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVSplitter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVVideoCodec)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DVVideoEnc)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DeviceControlCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DirectDraw)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DirectDrawClipper)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DirectDrawProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DirectShowPluginControl)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_Dither)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DtvCcFilter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_DvdGraphBuilder)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_EVRPlaybackPipelineOptimizer)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_EVRTearlessWindowPresenter9)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_EnhancedVideoRenderer)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_FGControl)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_FileSource)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_FileWriter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_FilterGraph)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_FilterGraphNoThread)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_FilterGraphPrivateThread)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_FilterMapper)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_FilterMapper2)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_ICodecAPIProxy)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_IVideoEncoderCodecAPIProxy)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_IVideoEncoderProxy)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_InfTee)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_LegacyAmFilterCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_Line21Decoder)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_Line21Decoder2)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MFSourceResolver)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MFVideoMixer9)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MFVideoPresenter9)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MJPGEnc)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MMSPLITTER)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MOVReader)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MPEG1Doc)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MPEG1PacketPlayer)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MPEG1Splitter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MPEG2Demultiplexer)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MPEG2Demultiplexer_NoClock)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MediaEncoderCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MediaMultiplexerCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MediaPropertyBag)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MemoryAllocator)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MidiRendererCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_MjpegDec)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_ModexProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_ModexRenderer)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_Mpeg2VideoStreamAnalyzer)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_NetworkProvider)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_OverlayMixer)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_PerformanceProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_PersistMonikerPID)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_ProtoFilterGraph)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_QTDec)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_QualityProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_QuickTimeParser)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_SBE2File)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_SBE2FileScan)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_SBE2MediaTypeProfile)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_SBE2Sink)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_SeekingPassThru)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_SmartTee)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_StreamBufferComposeRecording)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_StreamBufferConfig)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_StreamBufferPropertyHandler)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_StreamBufferRecordingAttributes)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_StreamBufferSink)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_StreamBufferSource)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_StreamBufferThumbnailHandler)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_SubtitlesFilter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_SystemClock)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_SystemDeviceEnum)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_TVAudioFilterPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_TVEFilterCCProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_TVEFilterStatsProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_TVEFilterTuneProperties)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_TVTunerFilterPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_TextRender)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_TransmitCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_URLReader)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VBISurfaces)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VPObject)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VPVBIObject)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VfwCapture)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VideoCompressorCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VideoInputDeviceCategory)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VideoMixingRenderer)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VideoMixingRenderer9)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VideoPortManager)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VideoProcAmpPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VideoRenderer)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VideoRendererDefault)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_VideoStreamConfigPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_WMAsfReader)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_WMAsfWriter)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_WSTDecoder)
        PENTACORN_KNOWN_GUID_AND_NAME(CLSID_WstDecoderPropertyPage)
        PENTACORN_KNOWN_GUID_AND_NAME(CODECAPI_ALLSETTINGS)
        PENTACORN_KNOWN_GUID_AND_NAME(CODECAPI_AUDIO_ENCODER)
        PENTACORN_KNOWN_GUID_AND_NAME(CODECAPI_AVDecMmcssClass)
        PENTACORN_KNOWN_GUID_AND_NAME(CODECAPI_CHANGELISTS)
        PENTACORN_KNOWN_GUID_AND_NAME(CODECAPI_CURRENTCHANGELIST)
        PENTACORN_KNOWN_GUID_AND_NAME(CODECAPI_SETALLDEFAULTS)
        PENTACORN_KNOWN_GUID_AND_NAME(CODECAPI_SUPPORTSEVENTS)
        PENTACORN_KNOWN_GUID_AND_NAME(CODECAPI_VIDEO_ENCODER)
        PENTACORN_KNOWN_GUID_AND_NAME(DSATTRIB_CAPTURE_STREAMTIME)
        PENTACORN_KNOWN_GUID_AND_NAME(DSATTRIB_CC_CONTAINER_INFO)
        PENTACORN_KNOWN_GUID_AND_NAME(DSATTRIB_DSHOW_STREAM_DESC)
        PENTACORN_KNOWN_GUID_AND_NAME(DSATTRIB_OptionalVideoAttributes)
        PENTACORN_KNOWN_GUID_AND_NAME(DSATTRIB_PBDATAG_ATTRIBUTE)
        PENTACORN_KNOWN_GUID_AND_NAME(DSATTRIB_PicSampleSeq)
        PENTACORN_KNOWN_GUID_AND_NAME(DSATTRIB_SAMPLE_LIVE_STREAM_TIME)
        PENTACORN_KNOWN_GUID_AND_NAME(DSATTRIB_TRANSPORT_PROPERTIES)
        PENTACORN_KNOWN_GUID_AND_NAME(DSATTRIB_UDCRTag)
        PENTACORN_KNOWN_GUID_AND_NAME(ENCAPIPARAM_BITRATE)
        PENTACORN_KNOWN_GUID_AND_NAME(ENCAPIPARAM_BITRATE_MODE)
        PENTACORN_KNOWN_GUID_AND_NAME(ENCAPIPARAM_PEAK_BITRATE)
        PENTACORN_KNOWN_GUID_AND_NAME(ENCAPIPARAM_SAP_MODE)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_AllowBatching)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_AllowDropToBob)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_AllowDropToHalfInterlace)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_AllowDropToThrottle)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_AllowScaling)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_ForceBatching)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_ForceBob)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_ForceHalfInterlace)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_ForceScaling)
        PENTACORN_KNOWN_GUID_AND_NAME(EVRConfig_ForceThrottle)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_525WSS)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_AnalogVideo)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_CAPTIONED_H264VIDEO)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_CAPTIONED_MPEG2VIDEO)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_CC_CONTAINER)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_DvInfo)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_MFVideoFormat)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_MPEGStreams)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_MPEGVideo)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_None)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_VideoInfo)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_VideoInfo2)
        PENTACORN_KNOWN_GUID_AND_NAME(FORMAT_WaveFormatEx)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IAMDirectSound)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IAMLine21Decoder)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IAMWstDecoder)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IBaseVideoMixer)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDDVideoPortContainer)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDraw)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDraw2)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawClipper)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawColorControl)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawKernel)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawPalette)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface2)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface3)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface4)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurface7)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawSurfaceKernel)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IDirectDrawVideo)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IFullScreenVideo)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IFullScreenVideoEx)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IMixerPinConfig)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IMixerPinConfig2)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IMpegAudioDecoder)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IQualProp)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IVPConfig)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IVPControl)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IVPNotify)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IVPNotify2)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IVPObject)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IVPVBIConfig)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IVPVBINotify)
        PENTACORN_KNOWN_GUID_AND_NAME(IID_IVPVBIObject)
        PENTACORN_KNOWN_GUID_AND_NAME(LOOK_DOWNSTREAM_ONLY)
        PENTACORN_KNOWN_GUID_AND_NAME(LOOK_UPSTREAM_ONLY)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_708_608Data)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_A2B10G10R10)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_A2R10G10B10)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AI44)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AIFF)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB32)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB32_D3D_DX7_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB32_D3D_DX9_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB1555)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB1555_D3D_DX7_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB1555_D3D_DX9_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB4444)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB4444_D3D_DX7_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ARGB4444_D3D_DX9_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AU)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AYUV)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_NTSC_M)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_B)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_D)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_G)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_H)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_I)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_M)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_N)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_PAL_N_COMBO)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_B)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_D)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_G)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_H)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_K)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_K1)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_AnalogVideo_SECAM_L)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Asf)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Avi)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CC_CONTAINER)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CFCC)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CLJR)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CLPL)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_CPLA)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DOLBY_AC3_SPDIF)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DRM_Audio)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DVB_SUBTITLES)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DVCS)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DVSD)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DssAudio)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DssVideo)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_DtvCcData)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_H264)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IA44)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IEEE_FLOAT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IF09)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IJPG)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IMC1)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IMC2)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IMC3)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IMC4)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ISDB_CAPTIONS)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_ISDB_SUPERIMPOSE)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_IYUV)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Line21_BytePair)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Line21_GOPPacket)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Line21_VBIRawData)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MDVF)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MJPG)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1Audio)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1AudioPayload)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1Packet)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1Payload)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1System)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1Video)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_MPEG1VideoCD)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_NV11)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_NV12)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_NV24)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_None)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Overlay)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P010)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P016)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P208)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P210)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P216)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_P408)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_PCM)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_PCMAudio_Obsolete)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Plum)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTJpeg)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTMovie)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTRle)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTRpza)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_QTSmc)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RAW_SPORT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB1)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB4)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB8)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB16_D3D_DX7_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB16_D3D_DX9_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB24)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB32)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB32_D3D_DX7_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB32_D3D_DX9_RT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB555)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_RGB565)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_S340)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_S342)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_SPDIF_TAG_241h)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_TELETEXT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_TVMJ)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_UYVY)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_VBI)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_VPS)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_VPVBI)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_VPVideo)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_WAKE)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_WAVE)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_WSS)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_XDS)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y41P)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y210)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y211)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y216)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_Y411)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YUY2)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YUYV)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YV12)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YVU9)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_YVYU)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dv25)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dv50)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dvh1)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dvhd)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dvsd)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIASUBTYPE_dvsl)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_AUXLine21Data)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_AUXTeletextPage)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_AnalogAudio)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_AnalogVideo)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_Audio)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_CC_CONTAINER)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_DTVCCData)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_File)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_Interleaved)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_LMRT)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_MPEG1SystemStream)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_MSTVCaption)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_Midi)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_ScriptCommand)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_Stream)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_Text)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_Timecode)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_URL_STREAM)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_VBI)
        PENTACORN_KNOWN_GUID_AND_NAME(MEDIATYPE_Video)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_AAC)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_ADTS)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_Base)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_DRM)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_DTS)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_Dolby_AC3_SPDIF)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_Float)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_MP3)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_MPEG)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_MSP1)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_PCM)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_WMASPDIF)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_WMAudioV8)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_WMAudioV9)
        PENTACORN_KNOWN_GUID_AND_NAME(MFAudioFormat_WMAudio_Lossless)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMPEG4Format_Base)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_Audio)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_Binary)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_Default)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_FileTransfer)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_HTML)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_Image)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_Protected)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_SAMI)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_Script)
        PENTACORN_KNOWN_GUID_AND_NAME(MFMediaType_Video)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_BottomFieldFirst)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_CleanPoint)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_DerivedFromTopField)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_DescrambleData)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_Discontinuity)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_GenKeyCtx)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_GenKeyFunc)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_Interlaced)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_PacketCrossOffsets)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_RepeatFirstField)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_SampleKeyID)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_SingleField)
        PENTACORN_KNOWN_GUID_AND_NAME(MFSampleExtension_Token)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_AUDIO_DECODER)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_AUDIO_EFFECT)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_AUDIO_ENCODER)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_DEMULTIPLEXER)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_MULTIPLEXER)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_OTHER)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_VIDEO_DECODER)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_VIDEO_EFFECT)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_VIDEO_ENCODER)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_CATEGORY_VIDEO_PROCESSOR)
        PENTACORN_KNOWN_GUID_AND_NAME(MFT_SUPPORT_DYNAMIC_FORMAT_CHANGE)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_AI44)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_ARGB32)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_AYUV)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_Base)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_DV25)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_DV50)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_DVC)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_DVH1)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_DVHD)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_DVSD)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_DVSL)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_H264)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_I420)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_IYUV)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_M4S2)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_MJPG)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_MP4S)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_MP4V)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_MP43)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_MPEG2)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_MPG1)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_MSS1)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_MSS2)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_NV11)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_NV12)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_P010)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_P016)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_P210)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_P216)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB8)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB24)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB32)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB555)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_RGB565)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_UYVY)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_WMV1)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_WMV2)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_WMV3)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_WVC1)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_Y41P)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_Y41T)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_Y42T)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_Y210)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_Y216)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_Y410)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_Y416)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_YUY2)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_YV12)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_YVU9)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_YVYU)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_v210)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_v216)
        PENTACORN_KNOWN_GUID_AND_NAME(MFVideoFormat_v410)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_DO_THINNING)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_MFT_CONTEXT)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_MFT_INPUT_STREAM_ID)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_OUTPUT_NODE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_PRESENTATION_TIME_OFFSET)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_SCRUBSAMPLE_TIME)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_SESSIONCAPS)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_SESSIONCAPS_DELTA)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_ACTUAL_START)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_CHARACTERISTICS)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_CHARACTERISTICS_OLD)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_FAKE_START)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_PROJECTSTART)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_SOURCE_TOPOLOGY_CANCELED)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_START_PRESENTATION_TIME)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_START_PRESENTATION_TIME_AT_OUTPUT)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_EVENT_TOPOLOGY_STATUS)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AAC_AUDIO_PROFILE_LEVEL_INDICATION)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AAC_PAYLOAD_TYPE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_ALL_SAMPLES_INDEPENDENT)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AM_FORMAT_TYPE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_ARBITRARY_FORMAT)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_ARBITRARY_HEADER)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_AVG_BYTES_PER_SECOND)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_BITS_PER_SAMPLE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_BLOCK_ALIGNMENT)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_CHANNEL_MASK)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_FLOAT_SAMPLES_PER_SECOND)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_FOLDDOWN_MATRIX)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_NUM_CHANNELS)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_PREFER_WAVEFORMATEX)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_SAMPLES_PER_BLOCK)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_SAMPLES_PER_SECOND)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_VALID_BITS_PER_SAMPLE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_WMADRC_AVGREF)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_WMADRC_AVGTARGET)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_WMADRC_PEAKREF)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AUDIO_WMADRC_PEAKTARGET)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AVG_BITRATE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_AVG_BIT_ERROR_RATE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_COMPRESSED)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_CUSTOM_VIDEO_PRIMARIES)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_DEFAULT_STRIDE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_DRM_FLAGS)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_DV_AAUX_CTRL_PACK_0)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_DV_AAUX_CTRL_PACK_1)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_DV_AAUX_SRC_PACK_0)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_DV_AAUX_SRC_PACK_1)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_DV_VAUX_CTRL_PACK)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_DV_VAUX_SRC_PACK)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_FIXED_SIZE_SAMPLES)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_FRAME_RATE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_FRAME_RATE_RANGE_MAX)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_FRAME_RATE_RANGE_MIN)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_FRAME_SIZE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_GEOMETRIC_APERTURE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_IMAGE_LOSS_TOLERANT)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_INTERLACE_MODE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MAJOR_TYPE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MAX_KEYFRAME_SPACING)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MINIMUM_DISPLAY_APERTURE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MPEG2_FLAGS)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MPEG2_LEVEL)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MPEG2_PROFILE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MPEG4_CURRENT_SAMPLE_ENTRY)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MPEG4_SAMPLE_DESCRIPTION)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MPEG_SEQUENCE_HEADER)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_MPEG_START_TIME_CODE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_ORIGINAL_4CC)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_ORIGINAL_WAVE_FORMAT_TAG)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_PAD_CONTROL_FLAGS)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_PALETTE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_PAN_SCAN_APERTURE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_PAN_SCAN_ENABLED)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_PIXEL_ASPECT_RATIO)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_SAMPLE_SIZE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_SOURCE_CONTENT_HINT)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_SUBTYPE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_TRANSFER_FUNCTION)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_USER_DATA)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_VIDEO_CHROMA_SITING)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_VIDEO_LIGHTING)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_VIDEO_NOMINAL_RANGE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_VIDEO_PRIMARIES)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_WRAPPED_TYPE)
        PENTACORN_KNOWN_GUID_AND_NAME(MF_MT_YUV_MATRIX)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_ANALOGVIDEOIN)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_CAPTURE)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_CC)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_EDS)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_NABTS)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_PREVIEW)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_STILL)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_TELETEXT)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_TIMECODE)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_VBI)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_VIDEOPORT)
        PENTACORN_KNOWN_GUID_AND_NAME(PIN_CATEGORY_VIDEOPORT_VBI)
        PENTACORN_KNOWN_GUID_AND_NAME(TIME_FORMAT_BYTE)
        PENTACORN_KNOWN_GUID_AND_NAME(TIME_FORMAT_FIELD)
        PENTACORN_KNOWN_GUID_AND_NAME(TIME_FORMAT_FRAME)
        PENTACORN_KNOWN_GUID_AND_NAME(TIME_FORMAT_MEDIA_TIME)
        PENTACORN_KNOWN_GUID_AND_NAME(TIME_FORMAT_NONE)
        PENTACORN_KNOWN_GUID_AND_NAME(TIME_FORMAT_SAMPLE)
        PENTACORN_KNOWN_GUID_AND_NAME(UUID_UdriTagTables)
        PENTACORN_KNOWN_GUID_AND_NAME(UUID_WMDRMTagTables)            
        PENTACORN_KNOWN_GUID_AND_NAME(GUID_NULL)            
    
    #undef PENTACORN_KNOWN_GUID_AND_NAME
};

GuidAndName* knownGuidNamesBegin = knownGuidNames;
GuidAndName* knownGuidNamesEnd = knownGuidNames + sizeof(knownGuidNames) / sizeof(knownGuidNames[0]);

std::string GuidToString(const GUID& guid)
{
    const int len = 37;
    char raw[len];     
    _snprintf_s(raw, len, "%08X-%04hX-%04hX-%02X%02X-%02X%02X%02X%02X%02X%02X",
                guid.Data1, guid.Data2, guid.Data3,
                static_cast<uint32_t>(guid.Data4[0]), static_cast<uint32_t>(guid.Data4[1]),
                static_cast<uint32_t>(guid.Data4[2]), static_cast<uint32_t>(guid.Data4[3]),
                static_cast<uint32_t>(guid.Data4[4]), static_cast<uint32_t>(guid.Data4[5]),
                static_cast<uint32_t>(guid.Data4[6]), static_cast<uint32_t>(guid.Data4[7]));
    return std::string(raw);
}

std::string GuidToName(const GUID& guid)
{
    // Todo, Jaap Suter, June 2010: not thread safe;
    static bool initialized = false;
    if (!initialized)
    {
        std::sort(knownGuidNamesBegin, knownGuidNamesEnd);
        initialized = true;
    }

    GuidAndName guidWithoutName = { guid, nullptr };
    std::pair<const GuidAndName*, const GuidAndName*> range = std::equal_range(knownGuidNamesBegin, knownGuidNamesEnd, guidWithoutName);
    if (0 == std::distance(range.first, range.second))
        return GuidToString(guid);
    else
        return std::string(range.first->name);
}

std::string SpecialCaseAttributeValue(const GUID& guid, const PROPVARIANT& var)
{
    if (guid == MF_MT_FRAME_RATE || 
        guid == MF_MT_FRAME_RATE_RANGE_MAX ||
        guid == MF_MT_FRAME_RATE_RANGE_MIN || 
        guid == MF_MT_FRAME_SIZE ||
        guid == MF_MT_PIXEL_ASPECT_RATIO)
    {
        UINT32 uHigh = 0;
        UINT32 uLow = 0;
        Unpack2UINT32AsUINT64(var.uhVal.QuadPart, &uHigh, &uLow);
		std::ostringstream str;
		str << uHigh << '/' << uLow;
        return str.str();
    }
    else return std::string();
}

void LogAttributeValueByIndex(IMFAttributes *pAttr, DWORD index)
{
    PROPVARIANT var;
    auto cleanup = [&var] () { PropVariantClear(&var); };

    std::ostream& ostr = std::cout;
        
    try
    {
        GUID guid = {};
        PropVariantInit(&var);

        Error = pAttr->GetItemByIndex(index, &guid, &var);
        
        ostr << "\t: " << GuidToName(guid) << std::endl;

        auto val = SpecialCaseAttributeValue(guid, var);
        if (val.size() > 0)
        {
            ostr << "\t: " << val << std::endl;
        }
        else
        {
            switch (var.vt)
            {
            case VT_UI4:
                ostr << "\t: " << var.ulVal << std::endl;
                break;

            case VT_UI8:
                ostr << "\t: " << *reinterpret_cast<std::int64_t*>(&var.uhVal) << std::endl;
                break;

            case VT_R8:
                ostr << "\t: " << var.dblVal << std::endl;
                break;

            case VT_CLSID:
                ostr << "\t: " << GuidToName(*var.puuid) << std::endl;
                break;

            case VT_LPWSTR:
                ostr << "\t: " << var.pwszVal << std::endl;
                break;

            case VT_VECTOR | VT_UI1:
                ostr << "\t: array<byte>";
                break;

            case VT_UNKNOWN:
                ostr << "\t: IUnknown" << std::endl;
                break;

            default:
                ostr << "\t: Unexpected attribute type (vt = " << var.vt << ")" << std::endl;
                break;
            }
        }
    }
    catch (const std::exception&)
    {
        cleanup();
        throw;
    }

    cleanup();
}

MediaTypeGrokker::MediaTypeGrokker(IMFMediaType* mediaType)
{
	UINT32 count = 0;

    Error = mediaType->GetCount(&count);
    
    for (UINT32 i = 0; i < count; i++)
        LogAttributeValueByIndex(mediaType, i);
}

}}}
